(function(a){"use strict";var b=function(b,c){this.options=a.extend({},a.fn.olightbox.defaults,c),this.trigger=a(b),this.fetchUrl=this.trigger.attr("data-target")||this.trigger.attr("href"),this.overlay=a("<div />"),this.lightbox=a("<div />").addClass(this.options.elements.wrapper.className),this.contentWrapper=a("<div />").addClass(this.options.elements.contentWrapper.className),this.content=null,this.dimension={width:window.innerWidth||a(window).width(),height:window.innerHeight||a(window).height()}};b.prototype={Constructor:b,prepare:function(){var b=this,c=a.Deferred();return this.showLoader(),a.when(this.buildContent()).then(function(){b.bindToClose(),c.resolve()}),c.promise()},showLoader:function(){this.overlay.addClass(this.options.elements.overlay.className).hide().appendTo("body").fadeIn(),0===this.overlay.children("."+this.options.elements.loader.className).length&&a("<div />").addClass(this.options.elements.loader.className).appendTo(this.overlay)},buildContent:function(){var b=this,c=this.fetchUrl,d=this.getContentType(this.fetchUrl),e=a.Deferred();switch(this.content=a("<div />"),d){case"img":this.content=a("<img />").attr("src",this.fetchUrl),c=null,this.lightbox.css("overflow","hidden"),b.content.css({"max-height":b.dimension.height-40});break;case"inline":c=" "+this.fetchUrl;break;default:}return this.content.load(c,function(a,c){"img"!==d&&"error"===c&&(a=b.options.errorMessage,b.lightbox.css({width:"20%",height:"20%"}),b.content.html(a),b.lightbox.addClass(b.options.elements.error.className)),b.lightbox.hide().appendTo("body"),b.content.appendTo(b.contentWrapper),b.contentWrapper.appendTo(b.lightbox);var g=(b.dimension.width-b.lightbox.width())/2,h=(b.dimension.height-b.lightbox.height())/2;g=0>g?0:g,h=0>h?0:h,b.lightbox.css({left:g,top:h}),e.resolve()}),e.promise()},show:function(){var b=this;a.when(this.prepare()).then(function(){b.lightbox.fadeIn(b.options.transitionSpeed)})},bindToClose:function(){var b=this;a("."+this.options.elements.overlay.className).on("click",function(){b.remove.apply(b)}),a(document).on("keydown",function(a){var c=a.key||a.which;27===c&&b.remove()})},remove:function(){var b=this;a("."+this.options.elements.overlay.className).remove(),this.lightbox.fadeOut(this.options.transitionSpeed,function(){a(this).empty().remove(),b.contentWrapper.empty()}),a("body").css("overflow","")},getContentType:function(a){var b="html";return this.isImage(a)?b="img":"#"===a.charAt(0)&&(b="inline"),b},isImage:function(a){return"string"==typeof a&&a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp)((\?|#).*)?$)/i)}},a.fn.olightbox=function(c){return this.each(function(){var d=a(this),e=d.data("olightbox"),f=a.extend({},a.fn.olightbox.defaults,d.data(),"object"==typeof c&&c);e||d.data("olightbox",e=new b(this,f)),"string"==typeof c?e[c]():f.show&&e.show()})},a.fn.olightbox.defaults={transition:"fadeIn",transitionSpeed:500,trigger:"click",show:!0,errorMessage:"Error!<br>Content not found.",elements:{overlay:{className:"olightbox-overlay"},wrapper:{className:"olightbox-wrapper"},contentWrapper:{className:"olightbox-content-wrapper"},loader:{className:"olightbox-loader"},error:{className:"olightbox-error"}}},a.fn.olightbox.Constructor=b,a(document).on(a.fn.olightbox.defaults.trigger+".olightbox",'[data-toggle="olightbox"]',function(b){a(this).olightbox(),b.preventDefault()})})(jQuery);