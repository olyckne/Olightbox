(function(b){var d=function(a,c){this.options=b.extend({},b.fn.olightbox.defaults,c);this.trigger=b(a);this.fetchUrl=this.trigger.attr("data-target")||this.trigger.attr("href");this.overlay=b("<div />");this.lightbox=b("<div />").addClass(this.options.elements.wrapper.className);this.contentWrapper=b("<div />").addClass(this.options.elements.contentWrapper.className);this.content=null;this.dimension={width:window.innerWidth||b(window).width(),height:window.innerHeight||b(window).height()}};d.prototype=
{Constructor:d,prepare:function(){var a=this,c=b.Deferred();this.showLoader();b.when(this.buildContent()).then(function(){a.bindToClose();c.resolve()});return c.promise()},showLoader:function(){this.overlay.addClass(this.options.elements.overlay.className).hide().appendTo("body").fadeIn();0===this.overlay.children("."+this.options.elements.loader.className).length&&b("<div />").addClass(this.options.elements.loader.className).appendTo(this.overlay)},buildContent:function(){var a=this,c=this.fetchUrl,
e=this.getContentType(this.fetchUrl),f=b.Deferred();this.content=b("<div />");switch(e){case "img":this.content=b("<img />").attr("src",this.fetchUrl);c=null;this.lightbox.css("overflow","hidden");a.content.css({"max-height":a.dimension.height-40,height:a.dimension.height-40});break;case "inline":c=" "+this.fetchUrl}this.content.load(c,function(b,c){"img"!==e&&"error"===c&&(b=a.options.errorMessage,a.lightbox.css({width:"20%",height:"20%"}),a.content.html(b),a.lightbox.addClass(a.options.elements.error.className));
a.lightbox.hide().appendTo("body");a.content.appendTo(a.contentWrapper);a.contentWrapper.appendTo(a.lightbox);var d=(a.dimension.width-a.lightbox.width())/2,g=(a.dimension.height-a.lightbox.height())/2;a.lightbox.css({left:0>d?0:d,top:0>g?0:g});f.resolve()});return f.promise()},show:function(){var a=this;b.when(this.prepare()).then(function(){a.lightbox.fadeIn(a.options.transitionSpeed)})},bindToClose:function(){var a=this;b("."+this.options.elements.overlay.className).on("click",function(){a.remove.apply(a)});
b(document).on("keydown",function(b){27===(b.key||b.which)&&a.remove()})},remove:function(){var a=this;b("."+this.options.elements.overlay.className).remove();this.lightbox.fadeOut(this.options.transitionSpeed,function(){b(this).empty().remove();a.contentWrapper.empty()});b("body").css("overflow","")},getContentType:function(a){var b="html";this.isImage(a)?b="img":"#"===a.charAt(0)&&(b="inline");return b},isImage:function(a){return"string"===typeof a&&a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp)((\?|#).*)?$)/i)}};
b.fn.olightbox=function(a){return this.each(function(){var c=b(this),e=c.data("olightbox"),f=b.extend({},b.fn.olightbox.defaults,c.data(),"object"==typeof a&&a);e||c.data("olightbox",e=new d(this,f));if("string"==typeof a)e[a]();else f.show&&e.show()})};b.fn.olightbox.defaults={transition:"fadeIn",transitionSpeed:500,trigger:"click",show:!0,errorMessage:"Error!<br>Content not found.",elements:{overlay:{className:"olightbox-overlay"},wrapper:{className:"olightbox-wrapper"},contentWrapper:{className:"olightbox-content-wrapper"},
loader:{className:"olightbox-loader"},error:{className:"olightbox-error"}}};b.fn.olightbox.Constructor=d;b(document).on(b.fn.olightbox.defaults.trigger+".olightbox",'[data-toggle="olightbox"]',function(a){b(this).olightbox();a.preventDefault()})})(jQuery);